%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 16.31 - HW #1
% Daniel Wiese
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

close all;
clear all;
clc;

s = tf('s');

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem #1

Ga = 1/((s^2+6*s+8)*(s^2+2*s+5));
Gb = (s^2-2*s+2)/(s*(s+2));
Gc = (s+3)/(s^4-4*s^2);

figure(1)
subplot(2, 2, 1)
rlocus(Ga)
locgrid(gca)
daspect([1, 1, 1])
axis([-6, 6, -4, 4])

subplot(2, 2, 2)
rlocus(Gb)
locgrid(gca)
daspect([1, 1, 1])

subplot(2, 2, 3)
rlocus(Gc)
locgrid(gca)
daspect([1, 1, 1])
axis([-6, 6, -4, 4])

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem #3

Kp = 0.178;
Kd = 0.444;
H = (Kp*0.9)/(s^2+0.9*Kd*s-0.03+0.9*Kp);
L = 0.9/(s^2+0.4*Kd*s-0.03);

figure(2)
subplot(2, 1, 1)
rlocus(L)
axis([-1, 1, -1, 1])
locgrid(gca)

[y,t] = impulse(H,40);

subplot(2, 1, 2)
plot(t,y,'-b','linewidth',1)
grid on
ylabel('\Theta')
xlabel('time')
title('Closed loop response: \Theta versus time in response to impulse input to \Theta_c')

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Problem #4

z = -1;
p = 3;
L4 = ((s-2)*(s+z))/(s*(s+p));

figure(3)
rlocus(L4)
daspect([1, 1, 1])

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
